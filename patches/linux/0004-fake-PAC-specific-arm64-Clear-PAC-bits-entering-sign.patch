From 1b2469883e37e8021bc385b6ad1066d576437e6e Mon Sep 17 00:00:00 2001
From: Peter Collingbourne <pcc@google.com>
Date: Mon, 29 Jun 2020 22:51:16 -0700
Subject: [PATCH 4/4] [fake PAC specific] arm64: Clear PAC bits entering signal
 handler even if non-PAC

---
 arch/arm64/kernel/signal.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/arm64/kernel/signal.c b/arch/arm64/kernel/signal.c
index 00d822049e98..f7be5c3ee178 100644
--- a/arch/arm64/kernel/signal.c
+++ b/arch/arm64/kernel/signal.c
@@ -733,7 +733,7 @@ static void setup_return(struct pt_regs *regs, struct k_sigaction *ka,
 	regs->regs[29] = (unsigned long)&user->next_frame->fp;
 
 	handler = (unsigned long)ka->sa.sa_handler;
-	if (system_supports_address_auth())
+	// if (system_supports_address_auth())
 		handler &= USER_DS;
 	regs->pc = handler;
 
-- 
2.27.0.212.ge8ba1cc988-goog

